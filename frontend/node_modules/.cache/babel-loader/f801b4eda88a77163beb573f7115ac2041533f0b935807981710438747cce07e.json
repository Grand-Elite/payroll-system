{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\weerasi-ps19259\\\\IdeaProjects\\\\payroll-system\\\\frontend\\\\src\\\\components\\\\Attendance\\\\UploadAttendanceExcel\\\\UploadAttendanceExcel.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { uploadAttendanceFile } from '../../../services/api';\nimport { Box, Button, LinearProgress, Typography, Paper } from '@mui/material';\nimport { CloudUpload } from '@mui/icons-material';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction UploadAttendanceExcel() {\n  _s();\n  const [file, setFile] = useState(null);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [successMessage, setSuccessMessage] = useState(\"\");\n  const onDrop = acceptedFiles => {\n    setFile(acceptedFiles[0]);\n    setUploadProgress(0); // Reset progress when a new file is selected\n  };\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive\n  } = useDropzone({\n    onDrop,\n    accept: '.csv, .xlsx',\n    multiple: false\n  });\n  const handleUpload = async () => {\n    if (!file) {\n      alert(\"Please select a file first.\");\n      return;\n    }\n    try {\n      const result = await uploadAttendanceFile(file, progressEvent => {\n        const percentCompleted = Math.round(progressEvent.loaded * 100 / progressEvent.total);\n        setUploadProgress(percentCompleted);\n      });\n      setSuccessMessage(\"File uploaded successfully!\");\n      console.log(result);\n    } catch (error) {\n      alert(\"Failed to upload file.\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    p: 3,\n    component: Paper,\n    elevation: 3,\n    style: {\n      maxWidth: 400,\n      margin: 'auto'\n    },\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h5\",\n      gutterBottom: true,\n      children: \"Upload Fingerprint Attendance File\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      ...getRootProps(),\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      p: 3,\n      mt: 2,\n      width: \"100%\",\n      height: 150,\n      border: \"2px dashed #3f51b5\",\n      borderRadius: 4,\n      style: {\n        cursor: 'pointer',\n        backgroundColor: isDragActive ? '#f0f0f0' : '#fafafa'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        ...getInputProps()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(CloudUpload, {\n        fontSize: \"large\",\n        color: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this), isDragActive ? /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body1\",\n        color: \"primary\",\n        children: \"Drop the file here...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body1\",\n        color: \"textSecondary\",\n        children: \"Drag & drop a file here, or click to select one\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 13\n      }, this), file && /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        color: \"textSecondary\",\n        mt: 1,\n        children: [\"Selected File: \", file.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      mt: 3,\n      width: \"100%\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleUpload,\n        variant: \"contained\",\n        color: \"secondary\",\n        fullWidth: true,\n        disabled: !file,\n        children: \"Upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this), uploadProgress > 0 && /*#__PURE__*/_jsxDEV(Box, {\n        mt: 2,\n        children: [/*#__PURE__*/_jsxDEV(LinearProgress, {\n          variant: \"determinate\",\n          value: uploadProgress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          color: \"textSecondary\",\n          align: \"center\",\n          children: [uploadProgress, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this), successMessage && /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        color: \"primary\",\n        align: \"center\",\n        mt: 2,\n        children: successMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 7\n  }, this);\n}\n_s(UploadAttendanceExcel, \"MZ6J1FxTj4c5DyRCMq1crRI3d1M=\", false, function () {\n  return [useDropzone];\n});\n_c = UploadAttendanceExcel;\n;\nexport default UploadAttendanceExcel;\nvar _c;\n$RefreshReg$(_c, \"UploadAttendanceExcel\");","map":{"version":3,"names":["React","useState","useDropzone","uploadAttendanceFile","Box","Button","LinearProgress","Typography","Paper","CloudUpload","jsxDEV","_jsxDEV","UploadAttendanceExcel","_s","file","setFile","uploadProgress","setUploadProgress","successMessage","setSuccessMessage","onDrop","acceptedFiles","getRootProps","getInputProps","isDragActive","accept","multiple","handleUpload","alert","result","progressEvent","percentCompleted","Math","round","loaded","total","console","log","error","display","flexDirection","alignItems","p","component","elevation","style","maxWidth","margin","children","variant","gutterBottom","fileName","_jsxFileName","lineNumber","columnNumber","justifyContent","mt","width","height","border","borderRadius","cursor","backgroundColor","fontSize","color","name","onClick","fullWidth","disabled","value","align","_c","$RefreshReg$"],"sources":["C:/Users/weerasi-ps19259/IdeaProjects/payroll-system/frontend/src/components/Attendance/UploadAttendanceExcel/UploadAttendanceExcel.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useDropzone } from 'react-dropzone';\r\nimport { uploadAttendanceFile } from '../../../services/api';\r\nimport {\r\n  Box,\r\n  Button,\r\n  LinearProgress,\r\n  Typography,\r\n  Paper,\r\n} from '@mui/material';\r\nimport { CloudUpload } from '@mui/icons-material';\r\n\r\n\r\nfunction UploadAttendanceExcel() {\r\n    const [file, setFile] = useState(null);\r\n    const [uploadProgress, setUploadProgress] = useState(0);\r\n    const [successMessage, setSuccessMessage] = useState(\"\");\r\n  \r\n    const onDrop = (acceptedFiles) => {\r\n      setFile(acceptedFiles[0]);\r\n      setUploadProgress(0); // Reset progress when a new file is selected\r\n    };\r\n  \r\n    const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n      onDrop,\r\n      accept: '.csv, .xlsx',\r\n      multiple: false,\r\n    });\r\n  \r\n    const handleUpload = async () => {\r\n      if (!file) {\r\n        alert(\"Please select a file first.\");\r\n        return;\r\n      }\r\n  \r\n      try {\r\n        const result = await uploadAttendanceFile(file, (progressEvent) => {\r\n          const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n          setUploadProgress(percentCompleted);\r\n        });\r\n        setSuccessMessage(\"File uploaded successfully!\");\r\n        console.log(result);\r\n      } catch (error) {\r\n        alert(\"Failed to upload file.\");\r\n      }\r\n    };\r\n  \r\n    return (\r\n      <Box\r\n        display=\"flex\"\r\n        flexDirection=\"column\"\r\n        alignItems=\"center\"\r\n        p={3}\r\n        component={Paper}\r\n        elevation={3}\r\n        style={{ maxWidth: 400, margin: 'auto' }}\r\n      >\r\n        <Typography variant=\"h5\" gutterBottom>\r\n          Upload Fingerprint Attendance File\r\n        </Typography>\r\n  \r\n        {/* Dropzone for drag and drop file upload */}\r\n        <Box\r\n          {...getRootProps()}\r\n          display=\"flex\"\r\n          flexDirection=\"column\"\r\n          alignItems=\"center\"\r\n          justifyContent=\"center\"\r\n          p={3}\r\n          mt={2}\r\n          width=\"100%\"\r\n          height={150}\r\n          border=\"2px dashed #3f51b5\"\r\n          borderRadius={4}\r\n          style={{\r\n            cursor: 'pointer',\r\n            backgroundColor: isDragActive ? '#f0f0f0' : '#fafafa',\r\n          }}\r\n        >\r\n          <input {...getInputProps()} />\r\n          <CloudUpload fontSize=\"large\" color=\"primary\" />\r\n          {isDragActive ? (\r\n            <Typography variant=\"body1\" color=\"primary\">\r\n              Drop the file here...\r\n            </Typography>\r\n          ) : (\r\n            <Typography variant=\"body1\" color=\"textSecondary\">\r\n              Drag & drop a file here, or click to select one\r\n            </Typography>\r\n          )}\r\n          {file && (\r\n            <Typography variant=\"body2\" color=\"textSecondary\" mt={1}>\r\n              Selected File: {file.name}\r\n            </Typography>\r\n          )}\r\n        </Box>\r\n  \r\n        <Box mt={3} width=\"100%\">\r\n          <Button\r\n            onClick={handleUpload}\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            fullWidth\r\n            disabled={!file}\r\n          >\r\n            Upload\r\n          </Button>\r\n          {uploadProgress > 0 && (\r\n            <Box mt={2}>\r\n              <LinearProgress variant=\"determinate\" value={uploadProgress} />\r\n              <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n                {uploadProgress}%\r\n              </Typography>\r\n            </Box>\r\n          )}\r\n          {successMessage && (\r\n          <Typography variant=\"body2\" color=\"primary\" align=\"center\" mt={2}>\r\n            {successMessage}\r\n          </Typography>\r\n        )}\r\n        </Box>\r\n      </Box>\r\n    );\r\n  };\r\n\r\nexport default UploadAttendanceExcel;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}